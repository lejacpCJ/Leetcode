# 1792. Maximum Average Pass Ratio

## Problem Info

- **Difficulty:** Medium
- **Topics:** Array, Greedy, Heap (Priority Queue)
- [Link to the problem](https://leetcode.com/problems/maximum-average-pass-ratio/)

## Description

You are given a 2D integer array `classes`, where `classes[i] = [passi, totali]` represents a class with `totali` students, of which `passi` will pass the exam. You are also given an integer `extraStudents`, representing extra brilliant students who are guaranteed to pass any class they are assigned to.

Assign each of the `extraStudents` to any class to maximize the average pass ratio across all classes. The pass ratio of a class is `passi / totali`. The average pass ratio is the sum of all class pass ratios divided by the number of classes.

Return the maximum possible average pass ratio after assigning the extra students. Answers within 1e-5 of the actual answer will be accepted.

## Examples

- **Input:** `classes = [[1,2],[3,5],[2,2]]`, `extraStudents = 2`  
  **Output:** `0.78333`  
  **Explanation:** Assign both extra students to the first class. The average pass ratio becomes `(3/4 + 3/5 + 2/2) / 3 = 0.78333`.

- **Input:** `classes = [[2,4],[3,9],[4,5],[2,10]]`, `extraStudents = 4`  
  **Output:** `0.53485`

## Constraints

- `1 <= classes.length <= 10^5`
- `classes[i].length == 2`
- `1 <= passi <= totali <= 10^5`
- `1 <= extraStudents <= 10^5`

---

## Solution

1. **Calculate Gain:** For each class, calculate the increase in pass ratio if an extra student is added.
2. **Use Max Heap:** Use a max heap to always assign the next extra student to the class where it increases the average the most.
3. **Update Heap:** After assigning a student, update the class and push the new gain back into the heap.
4. **Compute Average:** After all extra students are assigned, compute the average pass ratio.

**Complexity:**
- **Time:** O((n + extraStudents) log n), where n is the number of classes.
- **Space:** O(n), for the heap.

**Python Code:**

```python
from typing import List
import heapq

class Solution:
    def maxAverageRatio(self, classes: List[List[int]], extraStudents: int) -> float:
        # Helper to calculate the gain of adding a student
        def gain(p, t):
            return (p + 1) / (t + 1) - (p / t)
        
        # Max heap: store (-gain, p, t)
        heap = []
        for p, t in classes:
            heapq.heappush(heap, (-gain(p, t), p, t))
        
        for _ in range(extraStudents):
            neg_delta, p, t = heapq.heappop(heap)
            p += 1
            t += 1
            heapq.heappush(heap, (-gain(p, t), p, t))
        
        total = 0
        while heap:
            _, p, t = heapq.heappop(heap)
            total += p / t
        
        return total / len(classes)
```