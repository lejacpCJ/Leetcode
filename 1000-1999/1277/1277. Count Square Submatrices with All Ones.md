# 1277. Count Square Submatrices with All Ones

## Problem Info

- **Difficulty:** Medium
- **Topics:** Array, Dynamic Programming, Matrix
- [Link to the problem](https://leetcode.com/problems/count-square-submatrices-with-all-ones/)

## Description

Given an `m x n` matrix of ones and zeros, return how many square submatrices have all ones.

## Examples

- **Input:**
  ```
  matrix = [
    [0,1,1,1],
    [1,1,1,1],
    [0,1,1,1]
  ]
  ```
  **Output:** `15`
  **Explanation:**  
  There are 10 squares of side 1.  
  There are 4 squares of side 2.  
  There is 1 square of side 3.  
  Total number of squares = 10 + 4 + 1 = 15.

- **Input:**
  ```
  matrix = [
    [1,0,1],
    [1,1,0],
    [1,1,0]
  ]
  ```
  **Output:** `7`
  **Explanation:**  
  There are 6 squares of side 1.  
  There is 1 square of side 2.  
  Total number of squares = 6 + 1 = 7.

## Constraints

- `1 <= matrix.length <= 300`
- `1 <= matrix[0].length <= 300`
- `0 <= matrix[i][j] <= 1`

---

## Solution

1. **Dynamic Programming:**  
   For each cell `(i, j)`, if `matrix[i][j] == 1`, the largest square ending at `(i, j)` is `1 + min(top, left, top-left)`, where `top`, `left`, and `top-left` are the values for the cells above, to the left, and diagonally above-left.
2. **Sum Up:**  
   The sum of all DP values gives the total number of square submatrices with all ones.

**Complexity:**

- **Time:** O(m * n)
- **Space:** O(m * n) (can be optimized to O(n))

**Python Code:**

```python
from typing import List

class Solution:
    def countSquares(self, matrix: List[List[int]]) -> int:
        m, n = len(matrix), len(matrix[0])
        dp = [[0] * n for _ in range(m)]
        total = 0

        for i in range(m):
            for j in range(n):
                if matrix[i][j] == 1:
                    if i == 0 or j == 0:
                        dp[i][j] = 1
                    else:
                        dp[i][j] = 1 + min(dp[i-1][j], dp[i][j-1], dp[i-1][j-1])
                    total += dp[i][j]
        return total
```