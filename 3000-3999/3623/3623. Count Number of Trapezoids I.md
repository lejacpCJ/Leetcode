# 3623. Count Number of Trapezoids I

## Problem Info

- **Difficulty:** Medium
- **Topics:** Array, Hash Table, Math, Geometry
- [Link to the problem](https://leetcode.com/problems/count-number-of-trapezoids-i/)

## Description

You are given a 2D integer array `points`, where `points[i] = [xi, yi]` represents the coordinates of the ith point on the Cartesian plane.

A **horizontal trapezoid** is a convex quadrilateral with at least one pair of horizontal sides (i.e. parallel to the x-axis). Two lines are parallel if and only if they have the same slope.

Return the number of unique horizontal trapezoids that can be formed by choosing any four distinct points from `points`.

Since the answer may be very large, return it modulo $10^9 + 7$.

## Examples

- **Example 1:**

  - Input: `points = [[1,0],[2,0],[3,0],[2,2],[3,2]]`
  - Output: `3`
  - Explanation:  
    There are three distinct ways to pick four points that form a horizontal trapezoid:
    - Using points `[1,0], [2,0], [3,2], [2,2]`
    - Using points `[2,0], [3,0], [3,2], [2,2]`
    - Using points `[1,0], [3,0], [3,2], [2,2]`

- **Example 2:**

  - Input: `points = [[0,0],[1,0],[0,1],[2,1]]`
  - Output: `1`
  - Explanation:  
    There is only one horizontal trapezoid that can be formed.

## Constraints

- $4 \leq$ `points.length` $\leq 10^5$
- $-10^8 \leq xi, yi \leq 10^8$
- All points are pairwise distinct.

---

## Solution

1. **Group points by y-coordinate:**  
   Points with the same y-coordinate are horizontally aligned. For a horizontal trapezoid, we need two distinct y-levels, each with at least two points.

2. **Count pairs on each y-level:**  
   For each y-level with $k$ points, the number of ways to pick two points is $C(k,2) = k(k-1)/2$.

3. **Combine pairs from different y-levels:**  
   For every pair of y-levels, multiply the number of pairs from each to get the number of trapezoids formed.

4. **Sum over all pairs of y-levels:**  
   Use prefix sum to efficiently compute the total.

**Complexity:**

- **Time:** $O(n)$ (grouping and summing)
- **Space:** $O(n)$ (for storing groups)

**Python Code:**

```python
from typing import List
from collections import defaultdict

MOD = 10 ** 9 + 7

class Solution:
    def countTrapezoids(self, points: List[List[int]]) -> int:
        groups = defaultdict(int)
        for x, y in points:
            groups[y] += 1

        combs = []
        for v in groups.values():
            if v >= 2:
                combs.append(v * (v - 1) // 2)

        n = len(combs)
        ans = 0
        partial_sum = 0
        for i in range(n):
            ans = (ans + combs[i] * partial_sum) % MOD
            partial_sum += combs[i]

        return ans
```
