# 3318. Find X-Sum of All K-Long Subarrays I

## Problem Info

- **Difficulty:** Hard
- **Topics:** Array, Hash Table, Sliding Window, Heap (Priority Queue)
- [Link to the problem](https://leetcode.com/problems/find-x-sum-of-all-k-long-subarrays-i/)

## Description

You are given an array `nums` of `n` integers and two integers `k` and `x`.

The **x-sum** of an array is calculated by the following procedure:

1. Count the occurrences of all elements in the array.
2. Keep only the occurrences of the top `x` most frequent elements. If two elements have the same number of occurrences, the element with the bigger value is considered more frequent.
3. Calculate the sum of the resulting array.

Note that if an array has less than `x` distinct elements, its x-sum is the sum of the array.

Return an integer array `answer` of length `n - k + 1` where `answer[i]` is the x-sum of the subarray `nums[i..i + k - 1]`.

## Examples

- **Input:** `nums = [1,1,2,2,3,4,2,3]`, `k = 6`, `x = 2`  
  **Output:** `[6,10,12]`  
  **Explanation:**

  - For subarray `[1, 1, 2, 2, 3, 4]`, only elements 1 and 2 will be kept in the resulting array. Hence, `answer[0] = 1 + 1 + 2 + 2 = 6`.
  - For subarray `[1, 2, 2, 3, 4, 2]`, only elements 2 and 4 will be kept in the resulting array. Hence, `answer[1] = 2 + 2 + 2 + 4 = 10`. Note that 4 is kept in the array since it is bigger than 3 and 1 which occur the same number of times.
  - For subarray `[2, 2, 3, 4, 2, 3]`, only elements 2 and 3 are kept in the resulting array. Hence, `answer[2] = 2 + 2 + 2 + 3 + 3 = 12`.

- **Input:** `nums = [3,8,7,8,7,5]`, `k = 2`, `x = 2`  
  **Output:** `[11,15,15,15,12]`  
  **Explanation:**  
  Since `k == x`, `answer[i]` is equal to the sum of the subarray `nums[i..i + k - 1]`.

---

## Solution

1. **Sliding Window:** Iterate over all subarrays of length `k` using a sliding window.
2. **Count Frequencies:** For each window, count the frequency of each element.
3. **Select Top x Elements:** Sort the elements by frequency (descending), then by value (descending) for ties. Select the top `x` elements.
4. **Sum Occurrences:** For the selected elements, sum all their occurrences in the window.

**Complexity:**

- **Time:** O((n - k + 1) _ k _ log k) in the worst case, since for each window, we may need to sort up to `k` elements.
- **Space:** O(k) for the frequency map.

**Python Code:**

```python
class Solution:
    def findXSum(self, nums: List[int], k: int, x: int) -> List[int]:
        n = len(nums)
        answer = []
        for i in range(n - k + 1):
            window = nums[i:i+k]
            freq = Counter(window)
            # Sort by frequency descending, then value descending
            top = sorted(freq.items(), key=lambda item: (-item[1], -item[0]))
            # Get the set of top x elements
            top_x = set([val for val, cnt in top[:x]])
            # Sum only occurrences of top x elements
            s = sum(num for num in window if num in top_x)
            answer.append(s)
        return answer
```
