# 3484. Design Spreadsheet

## Problem Info

- Difficulty: Medium
- Topics: Array, Hash Table, String, Design, Matrix
- Link: https://leetcode.com/problems/design-spreadsheet

## Description

A spreadsheet is a grid with 26 columns (labeled 'A' to 'Z') and a given number of rows. Each cell holds an integer between 0 and 10^5.

Implement the Spreadsheet class:

- Spreadsheet(int rows) — Initializes a spreadsheet with 26 columns and the given number of rows. All cells start at 0.
- void setCell(String cell, int value) — Sets the value of the specified cell (e.g., "A1", "B10").
- void resetCell(String cell) — Resets the specified cell to 0.
- int getValue(String formula) — Evaluates a formula of the form "=X+Y", where X and Y are either cell references or non-negative integers, and returns the sum. Cells not explicitly set are treated as 0.

## Example

Input:
["Spreadsheet", "getValue", "setCell", "getValue", "setCell", "getValue", "resetCell", "getValue"]
[[3], ["=5+7"], ["A1", 10], ["=A1+6"], ["B2", 15], ["=A1+B2"], ["A1"], ["=A1+B2"]]

Output:
[null, 12, null, 16, null, 25, null, 15]

Explanation:
- Spreadsheet spreadsheet = new Spreadsheet(3);
- spreadsheet.getValue("=5+7"); // 12
- spreadsheet.setCell("A1", 10);
- spreadsheet.getValue("=A1+6"); // 16
- spreadsheet.setCell("B2", 15);
- spreadsheet.getValue("=A1+B2"); // 25
- spreadsheet.resetCell("A1");
- spreadsheet.getValue("=A1+B2"); // 15

## Constraints

- 1 <= rows <= 10^3
- 0 <= value <= 10^5
- Formula is always "=X+Y" where X and Y are either valid cell refs or non-negative integers <= 10^5.
- Cell refs: uppercase letter 'A'..'Z' followed by row 1..rows.
- At most 10^4 calls total.

---

## Solution

- Maintain a 26xrows grid (columns 'A'..'Z') initialized to 0.
- setCell and resetCell update the grid directly.
- getValue parses the formula after the '=' splitting by '+'; for each operand, if it's numeric parse to int, otherwise read the corresponding cell value (column letter + row index - 1).
- No dependency graph or recursion needed since formulas only contain two operands which are either literals or direct cell reads.

Complexity:
- Time: O(1) per setCell/resetCell/getValue (parsing and direct access).
- Space: O(rows * 26).

## Python Implementation

```python
from collections import defaultdict
import string

class Spreadsheet:

    def __init__(self, rows: int):
        # 26 columns 'A'..'Z', each column is a list of length rows initialized to 0
        self.sheet = defaultdict(list)
        for ch in string.ascii_uppercase:
            self.sheet[ch] = [0] * rows

    def setCell(self, cell: str, value: int) -> None:
        col = cell[0]
        row = int(cell[1:]) - 1
        self.sheet[col][row] = value

    def resetCell(self, cell: str) -> None:
        col = cell[0]
        row = int(cell[1:]) - 1
        self.sheet[col][row] = 0

    def getValue(self, formula: str) -> int:
        # formula format: "=X+Y"
        parts = formula[1:].partition('+')
        left, right = parts[0], parts[2]

        def getCellValue(token: str) -> int:
            if token.isnumeric():
                return int(token)
            col = token[0]
            row = int(token[1:]) - 1
            return self.sheet[col][row]

        return getCellValue(left) + getCellValue(right)